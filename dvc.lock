schema: '2.0'
stages:
  load_dataset:
    cmd: python ./src/data/load_dataset.py
    deps:
    - path: ./src/data/load_dataset.py
      hash: md5
      md5: a8a534f0e8da1dda51a97bd458cb3064
      size: 2872
    params:
      params.yaml:
        load_dataset.bucket: datasetbucket
        load_dataset.filename: WineQT.csv
        load_dataset.raw_data: /data/raw
    outs:
    - path: ./data/raw/WineQT.csv
      hash: md5
      md5: c4ca69c2088b0d7fe9be7e8d33106695
      size: 71823
  make_dataset:
    cmd: python ./src/data/make_dataset.py
    deps:
    - path: ./data/raw/WineQT.csv
      hash: md5
      md5: c4ca69c2088b0d7fe9be7e8d33106695
      size: 71823
    - path: ./src/data/make_dataset.py
      hash: md5
      md5: 8bf252df39adfc976db6502ac8a7bd28
      size: 3698
    params:
      params.yaml:
        load_dataset.filename: WineQT.csv
        load_dataset.raw_data: /data/raw
        make_dataset.processed_data: /data/processed
        make_dataset.res_seed: 42
        make_dataset.seed: 41
        make_dataset.test_split: 0.25
    outs:
    - path: ./data/processed/test.csv
      hash: md5
      md5: ad48d3c4e5f3a042ccf540a6e237bd5c
      size: 104695
    - path: ./data/processed/train.csv
      hash: md5
      md5: 65f8c437f89c9ab2b9a724feb0056432
      size: 314608
  build_features:
    cmd: python ./src/features/build_features.py
    deps:
    - path: ./data/processed/test.csv
      hash: md5
      md5: ad48d3c4e5f3a042ccf540a6e237bd5c
      size: 104695
    - path: ./data/processed/train.csv
      hash: md5
      md5: 65f8c437f89c9ab2b9a724feb0056432
      size: 314608
    - path: ./src/features/build_features.py
      hash: md5
      md5: ac74288d13827cfe74b370cb76d4a8df
      size: 3229
    params:
      params.yaml:
        build_features.extended_data: /data/extended
        make_dataset.processed_data: /data/processed
    outs:
    - path: ./data/extended/extended_test.csv
      hash: md5
      md5: 56ef2daa1f6940621c3ba0f87e10b0c1
      size: 200566
    - path: ./data/extended/extended_train.csv
      hash: md5
      md5: db4ce59faea54e04dae93af1e942f4c2
      size: 601982
  train_model:
    cmd: python ./src/models/train_model.py
    deps:
    - path: ./data/extended/extended_test.csv
      hash: md5
      md5: 56ef2daa1f6940621c3ba0f87e10b0c1
      size: 200566
    - path: ./data/extended/extended_train.csv
      hash: md5
      md5: db4ce59faea54e04dae93af1e942f4c2
      size: 601982
    - path: ./src/models/train_model.py
      hash: md5
      md5: 836c5a4b134c319ee2515bf74dbf6dfc
      size: 5876
    params:
      params.yaml:
        base.target: quality
        build_features.extended_data: /data/extended
        mlflow_config.remote_server_uri: http://ec2-54-227-229-29.compute-1.amazonaws.com:5000
        mlflow_config.trainingExpName: modeltraining
        train_model.criterion: gini
        train_model.max_depth: 50
        train_model.min_samples_leaf: 30
        train_model.min_samples_split: 60
        train_model.model_dir: /models
        train_model.n_estimators: 50
        train_model.random_state: 42
    outs:
    - path: ./models/model.joblib
      hash: md5
      md5: 8f3c4f0cd0cbfed814608006f2d432b9
      size: 412585
  tune_model:
    cmd: python ./src/models/tune_model.py
    deps:
    - path: ./data/extended/extended_test.csv
      hash: md5
      md5: 56ef2daa1f6940621c3ba0f87e10b0c1
      size: 200566
    - path: ./data/extended/extended_train.csv
      hash: md5
      md5: db4ce59faea54e04dae93af1e942f4c2
      size: 601982
    - path: ./src/models/tune_model.py
      hash: md5
      md5: a63ec7e68dab1752d164ca74ec613de5
      size: 8280
    params:
      params.yaml:
        base.target: quality
        build_features.extended_data: /data/extended
        hyperopt.max_eval: 100
        hyperopt.model_name: best_model
        mlflow_config.remote_server_uri: http://ec2-54-227-229-29.compute-1.amazonaws.com:5000
        mlflow_config.tunningExpName: modeltunning
    outs:
    - path: ./models/best_model.joblib
      hash: md5
      md5: 1c0ef55eb790304d5597763e36c42e1d
      size: 1173753
